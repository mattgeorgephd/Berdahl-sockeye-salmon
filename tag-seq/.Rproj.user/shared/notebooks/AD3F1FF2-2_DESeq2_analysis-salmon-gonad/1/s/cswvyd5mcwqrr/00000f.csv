"0","# How many genes are differentially expressed compared to Control?"
"0","colnames(Onerka_feature_table) <- c(""gene"",""description"")"
"0","all_genes           <- all_genes %>% arrange(-log2FoldChange)"
"0","all_genes$treatment <- ""gonad"""
"0",""
"0","all_genes_normal           <- left_join(res_table_normal, Onerka_feature_table, by = ""gene"")"
"0","all_genes_normal           <- all_genes_normal %>% arrange(-log2FoldChange)"
"0",""
"0","all_genes_apeglm           <- left_join(res_table_apeglm, Onerka_feature_table, by = ""gene"")"
"0","all_genes_apeglm           <- all_genes_apeglm %>% arrange(-log2FoldChange)"
"0","all_genes_apeglm$treatment <- ""gonad"""
"0",""
"0","all_genes_ashr           <- left_join(res_table_ashr, Onerka_feature_table, by = ""gene"")"
"0","all_genes_ashr$treatment <- ""gonad"""
"0",""
"0","# Filter results by"
"0","sig_genes <- res_table %>%"
"0","  filter(padj < padj.cutoff)"
"0","sig_genes <- left_join(sig_genes, Onerka_feature_table, by = ""gene"")"
"0","sig_genes <- sig_genes %>% arrange(-log2FoldChange)"
"0","sig_genes$treatment <- ""gonad"" "
"0","  filter(padj < padj.cutoff)"
"0","sig_genes_normal <- left_join(sig_genes_normal, Onerka_feature_table, by = ""gene"")"
"0","sig_genes_normal <- sig_genes_normal %>% arrange(-log2FoldChange)"
"0","sig_genes_normal$treatment <- ""gonad"" "
"0","sig_genes_apeglm <- res_table_apeglm %>%"
"0","  filter(padj < padj.cutoff)"
"0","sig_genes_apeglm <- left_join(sig_genes_apeglm, Onerka_feature_table, by = ""gene"")"
"0","sig_genes_apeglm <- sig_genes_apeglm %>% arrange(-log2FoldChange)"
"0","sig_genes_apeglm$treatment <- ""gonad"" "
"0",""
"0","sig_genes_ashr <- res_table_ashr %>%"
"0","  filter(padj < padj.cutoff)"
"0","sig_genes_ashr$treatment <- ""gonad"" "
"0",""
"0","# Save single gene expression counts to a data frame object, for each shrinkage estimator"
"0","single_gene_expression_unshrunk <- data.frame()"
"0","for (i in 1:nrow(sig_genes)){"
"0","  LOCID <- sig_genes$gene[i]"
"0","  gene_counts_data <- plotCounts(dds, gene=LOCID, intgroup=""trt"", returnData=TRUE)"
"0","  row.names(gene_counts_data) <- NULL"
"0","  single_gene_expression_unshrunk <- rbind(single_gene_expression_unshrunk,gene_counts_data)"
"0","  rm(gene_counts_data)"
"0","}"
"0",""
"0","single_gene_expression_normal <- data.frame()"
"0","for (i in 1:nrow(sig_genes_normal)){"
"0","  LOCID <- sig_genes_normal$gene[i]"
"0","  gene_counts_data <- plotCounts(dds, gene=LOCID, intgroup=""trt"", returnData=TRUE)"
"0","  gene_counts_data$gene <- LOCID"
"0","  single_gene_expression_normal <- rbind(single_gene_expression_normal,gene_counts_data)"
"0","  rm(gene_counts_data)"
"0","}"
"0",""
"0",""
"0","single_gene_expression_apeglm <- data.frame()"
"0","for (i in 1:nrow(sig_genes_apeglm)){"
"0","  LOCID <- sig_genes_apeglm$gene[i]"
"0","  gene_counts_data <- plotCounts(dds, gene=LOCID, intgroup=""trt"", returnData=TRUE)"
"0","  gene_counts_data$gene <- LOCID"
"0","  row.names(gene_counts_data) <- NULL"
"0","  single_gene_expression_apeglm <- rbind(single_gene_expression_apeglm,gene_counts_data)"
"0","  rm(gene_counts_data)"
"0","}"
"0",""
"0","single_gene_expression_ashr <- data.frame()"
"0","for (i in 1:nrow(sig_genes_ashr)){"
"0","  LOCID <- sig_genes_ashr$gene[i]"
"0","  gene_counts_data <- plotCounts(dds, gene=LOCID, intgroup=""trt"", returnData=TRUE)"
"0","  gene_counts_data$gene <- LOCID"
"0","  gene_counts_data$sample <- row.names(gene_counts_data)"
"0","  single_gene_expression_ashr <- rbind(single_gene_expression_ashr,gene_counts_data)"
"0","  rm(gene_counts_data)"
"0","}"
"0",""
"0","write.table(single_gene_expression_unshrunk, file = ""DESEQ_output/gonad/GONAD-unshrunk-single-gene-counts.csv"", row.names = FALSE)"
"0","write.table(single_gene_expression_apeglm, file = ""DESEQ_output/gonad/GONAD-apeglm-single-gene-counts.csv"", row.names = FALSE)"
"0",""
"0","print(paste(""# genes before filtering:"", nrow(cts))) # count number of genes before filtering"
"1","[1]"
"1"," ""# genes before filtering: 37942"""
"1","
"
"0","print(paste(""# genes after filtering:"", length(dds))) # count number of genes after filtering"
"1","[1]"
"1"," ""# genes after filtering: 20105"""
"1","
"
"0","print(paste(""# of genes dropped:"", nrow(cts) - length(dds), sep="" "")) # count number of genes dropped"
"1","[1]"
"1"," ""# of genes dropped: 17837"""
"1","
"
"0","print(paste(""# DEGs, all-genes:"", nrow(all_genes)))"
"1","[1]"
"1"," ""# DEGs, all-genes: 18156"""
"1","
"
"0","print(paste(""# DEGs, unshrunken, pvalue = 0.05:"", nrow(sig_genes)))"
"1","[1]"
"1"," ""# DEGs, unshrunken, pvalue = 0.05: 1653"""
"1","
"
"0","print(paste(""# DEGs, normal shrinkage estimator, pvalue = 0.05:"", nrow(sig_genes_normal)))"
"1","[1]"
"1"," ""# DEGs, normal shrinkage estimator, pvalue = 0.05: 1630"""
"1","
"
"0","print(paste(""# DEGs, apeglm shrinkage estimator, pvalue = 0.05:"", nrow(sig_genes_apeglm)))"
"1","[1]"
"1"," ""# DEGs, apeglm shrinkage estimator, pvalue = 0.05: 1630"""
"1","
"
"0","print(paste(""# DEGs, ashr shrinkage estimator, pvalue = 0.05:"", nrow(sig_genes_ashr)))"
"1","[1]"
"1"," ""# DEGs, ashr shrinkage estimator, pvalue = 0.05: 1630"""
"1","
"
"0","gene_counts <- as.data.frame(c(nrow(cts),length(dds),(nrow(cts)-length(dds)),nrow(all_genes),"
"0","                            nrow(all_genes_normal),nrow(all_genes_apeglm),nrow(all_genes_ashr),"
"0","                            nrow(sig_genes),nrow(sig_genes_normal),"
"0","                            nrow(sig_genes_apeglm),nrow(sig_genes_ashr)))"
"0","row.names(gene_counts) <- c(""genes_before_filtering"",""genes_after_filtering"",""genes_dropped"","
"0","                            ""DEG_unshrunken-p0.05"",""DEG_normal-p0.05"","
"0","                            ""DEG_apeglm-p0.05"",""DEG_ashr-p0.05"")"
"0","colnames(gene_counts) <- ""count"""
"0",""
"0","# Output tables of DEGs"
"0","write.table(all_genes,        file = ""DESEQ_output/gonad/GONAD-ALL-DEG.csv"",            row.names = FALSE, sep = "","")"
"0","write.table(all_genes_normal, file = ""DESEQ_output/gonad/GONAD-ALL-DEG-normal.csv"",     row.names = FALSE, sep = "","")"
"0","write.table(all_genes_apeglm, file = ""DESEQ_output/gonad/GONAD-ALL-DEG-apeglm.csv"",     row.names = FALSE, sep = "","")"
"0","write.table(all_genes_ashr,   file = ""DESEQ_output/gonad/GONAD-ALL-DEG-ashr.csv"",       row.names = FALSE, sep = "","")"
"0","write.table(sig_genes,        file = ""DESEQ_output/gonad/GONAD-SIG-DEG-unshrunken.csv"", row.names = FALSE, sep = "","")"
"0","write.table(sig_genes_normal, file = ""DESEQ_output/gonad/GONAD-SIG-DEG-normal.csv"",     row.names = FALSE, sep = "","")"
"0","write.table(sig_genes_apeglm, file = ""DESEQ_output/gonad/GONAD-SIG-DEG-apeglm.csv"",     row.names = FALSE, sep = "","")"
"2","Warning: cannot open file 'DESEQ_output/gonad/GONAD-SIG-DEG-apeglm.csv': Permission denied"
"2","Error in file(file, ifelse(append, ""a"", ""w"")) : 
  cannot open the connection
"

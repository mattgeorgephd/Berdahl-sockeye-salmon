"0","# Grab all results from DESeq2 results table"
"0","all <- na.omit(res_table_apeglm)"
"0","df_all <- as.data.frame(all)"
"0","row.names(df_all) <- df_all$gene"
"0",""
"0","# Get list of genes and associated metadata"
"0","sigs <- all[all$padj < 0.05,]"
"0","sigs <- left_join(sigs, Onerka_feature_table, by = 'gene')"
"0","df_sigs <- as.data.frame(sigs)"
"0","row.names(df_sigs) <- df_sigs$gene"
"0",""
"0","# Get normalized count data from dds object"
"0","rlog_out <- rlog(dds, blind=FALSE) "
"0","mat_all <- assay(rlog_out)[rownames(df_all), rownames(coldata_trt)]"
"0","colnames(mat_all) <- rownames(coldata_trt)"
"0","mat_sigs <- assay(rlog_out)[rownames(df_sigs), rownames(coldata_trt)]"
"0","colnames(mat_sigs) <- rownames(coldata_trt)"
"0",""
"0","# Generate Z-score"
"0","mat.scaled_all <- t(apply(mat_all, 1, scale)) #center and scale each column (Z-score) then transpose"
"0","colnames(mat.scaled_all)<-colnames(mat_all)"
"0","colnames(mat.scaled_sigs)<-colnames(mat_sigs)"
"0",""
"0","# Plot heatmap"
"0","png(filename = ""DESEQ_output/liver/liver_heatmap_pval_genes_apeglm.png"", "
"0","    res = 1200, width = 6000, height = 6000, units = ""px"", pointsize = 6)"
"0","# par(mar=c(5,8,4,1)+.1)"
"0","heatmap(mat.scaled_sigs, scale = ""none"", col =  col, "
"0","        ColSideColors = c(rep(""royalblue1"", 15), rep(""red3"", 15)))"
